# CSS 选择器与优先级

## 1. 选择器类型大全

| 分类 | 选择器 | 示例 | 描述 |
|------|--------|------|------|
| **基础** | 通配符 | `*` | 选中所有元素 |
| | 标签 | `div`, `p` | 选中指定标签 |
| | ID | `#app` | 选中 id="app" 的元素 |
| | 类 | `.box` | 选中 class="box" 的元素 |
| **属性** | 属性 | `[type="text"]` | 选中特定属性的元素 |
| **关系** | 后代 | `div p` | 选中 div 内部的所有 p |
| | 子代 | `div > p` | 选中 div 的直接子元素 p |
| | 相邻兄弟 | `h1 + p` | 选中紧跟在 h1 后的 p |
| | 通用兄弟 | `h1 ~ p` | 选中 h1 后面的所有 p |
| **伪类** | 状态 | `:hover`, `:active` | 鼠标悬停、激活状态 |
| | 结构 | `:nth-child(n)` | 第 n 个子元素 |
| | 逻辑 | `:not(.active)` | 排除类名为 active 的元素 |
| **伪元素**| 内容 | `::before`, `::after` | 元素前/后插入内容 |

---

## 2. 优先级 (权重) 计算

**权重规则：(行内样式, ID, 类/属性/伪类, 标签/伪元素)**

将其看作一个 4 位的数字（实际上是无穷大进制，不单纯是十进制）：

| 选择器类型 | 权重值 |
|------------|--------|
| `!important` | **最高 (Infinity)** |
| 行内样式 `style=""` | **1000** (1,0,0,0) |
| ID 选择器 | **0100** (0,1,0,0) |
| 类、属性、伪类 | **0010** (0,0,1,0) |
| 标签、伪元素 | **0001** (0,0,0,1) |
| 通配符、继承、浏览器默认 | **0000** |

### 计算示例

```css
/* 权重：0,0,0,1 */
div { color: red; }

/* 权重：0,0,1,1 (类+标签) */
.box span { color: blue; }

/* 权重：0,1,0,1 (ID+标签) */
#app div { color: green; }

/* 权重：0,0,2,0 (两个类) */
.nav .item { color: yellow; }
```

### 比较规则

1. **从左向右逐位比较**：先比 ID 位，ID 多的胜出；ID 相同比类位...
2. **权重相同，后来居上**：写在 CSS 文件后面的覆盖前面的。
3. **继承的样式权重最低**：即使是 ID 选择器上的样式，对于子元素来说也是"继承"来的，不如子元素自身的标签选择器。

---

## 3. 面试陷阱题

### 题目 1：11 个类能抵消 1 个 ID 吗？

```css
#id { color: red; }
.c1.c2.c3.c4.c5.c6.c7.c8.c9.c10.c11 { color: blue; }
```
**答案：不能。**
ID 所在的权重位级别更高，类选择器无论多少个都无法超越一个 ID 选择器。CSS 规范中，这四个槽位是独立比较的（可以理解为无穷大进制），不存在"溢出"的概念。

### 题目 2：伪类 `:not()` 参与权重计算吗？

```css
div:not(.active) { color: red; }
```
**答案：`:not()` 本身不增加权重，但它里面的参数参与计算。**
权重 = `div` (1) + `.active` (10) = 11。

### 题目 3：此处的文字是什么颜色？

```html
<div id="app" class="box" style="color: blue;">
  <p>Text</p>
</div>
```

```css
#app .box { color: red !important; }
p { color: green; }
```

**答案：绿色 (green)。**
虽然父级有 `!important`，但那是父级的样式。对于 `<p>` 标签来说，`color: red` 是**继承**来的。
**继承的权重为 0**。
`<p>` 自身有标签选择器（权重 1），所以 1 > 0，显示绿色。

要想让红色生效，必须直接选中 p：
`#app .box p { color: red !important; }`

---

## 4. 最佳实践

1. **尽量少用 ID 选择器**：ID 权重过高，难以覆盖，不利于复用。
2. **少用 `!important`**：这是核武器，用了就很难回头，除非为了覆盖内联样式或第三方库。
3. **使用 BEM 命名法**：保持 CSS 扁平，降低优先级冲突风险。
   - `.block__element--modifier` (权重都是 10，很公平)。
