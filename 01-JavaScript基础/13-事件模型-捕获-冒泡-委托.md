# 事件机制：捕获 / 冒泡 / 委托

## 事件流三阶段

1. **捕获阶段**：从 Window → document → ... → 目标元素，先捕获。
2. **目标阶段**：事件到达目标元素。
3. **冒泡阶段**：从目标元素向上冒泡到 Window。

`addEventListener(type, listener, options)`：
- `options.capture`（或第三个参数为 true）：监听捕获阶段。
- 默认监听冒泡阶段。

## 常用控制方法

- 阻止冒泡：`event.stopPropagation()`
- 阻止当前节点后续监听器：`event.stopImmediatePropagation()`
- 阻止默认行为：`event.preventDefault()`
- Vue 修饰符：`.stop`（阻止冒泡）、`.capture`（捕获阶段）、`.prevent`（阻止默认）

## 事件委托（事件代理）

**思想**：把子元素的事件交给父元素处理，利用冒泡减少监听器数量。

```html
<ul id="list">
  <li data-id="1">A</li>
  <li data-id="2">B</li>
</ul>
<script>
document.getElementById('list').addEventListener('click', (e) => {
  const li = e.target.closest('li')
  if (!li) return
  console.log('clicked', li.dataset.id)
})
</script>
```

**好处**：
- 性能好：大量子元素时只需一个监听器。
- 动态性强：新插入/删除的子元素也能自动处理。
- 便于统一逻辑和回收。

**注意**：
- `event.target` 可能是子元素，必要时用 `closest()` 或判断 `tagName`。
- 某些事件不冒泡（如 `blur` / `focus`），需用捕获或 `focusin/focusout`。
